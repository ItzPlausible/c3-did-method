%% C3 DID Method â€” Faction Credential Lifecycle
%% Version: 0.4 | Date: 2026-02-08
%% State machine for faction credential issuance, suspension, revocation, and renewal

stateDiagram-v2
    [*] --> NoCredential: Entity registered<br/>(no faction membership)

    NoCredential --> PendingReview: Steward submits<br/>credential request
    
    PendingReview --> Active: Faction governance<br/>body approves
    PendingReview --> Rejected: Faction governance<br/>body denies
    
    Rejected --> PendingReview: Steward resubmits<br/>(updated attestations)
    Rejected --> [*]: Steward abandons<br/>request

    state Active {
        [*] --> Earning
        Earning --> Earning: PPT sub-tokens minted<br/>to TIT Vault per<br/>Impact Offer completion
        
        note right of Earning
            Entity actively earns PPT sub-type
            (PDT/PCT/PMT) corresponding to
            this faction credential's type
        end note
    }
    
    Active --> Suspended: Faction governance<br/>suspends (reversible)
    Active --> RenewalPending: validUntil approaching<br/>(30-day warning)
    Active --> Revoked: Faction governance<br/>revokes credential
    Active --> Revoked: Steward voluntarily<br/>withdraws from faction
    Active --> Revoked: Credential expires<br/>(validUntil passed)
    Active --> Decommissioned: Entity decommissioned<br/>(all credentials revoked)

    Suspended --> Active: Faction governance<br/>reinstates
    Suspended --> Revoked: Suspension not<br/>resolved in 90 days
    
    RenewalPending --> Active: Renewal approved<br/>(new validUntil set)
    RenewalPending --> Revoked: Renewal denied<br/>or not submitted

    state Revoked {
        [*] --> StatusListFlipped
        StatusListFlipped --> Archived
        
        note right of StatusListFlipped
            StatusList2021 bit flipped
            IPFS bitstring re-pinned
            Cardano L1 hash anchored
            PPT earning for this faction STOPS
        end note
        
        note right of Archived
            Credential history preserved
            on IPFS for audit trail
            Entity may request new
            credential (fresh application)
        end note
    }
    
    Revoked --> PendingReview: Steward requests<br/>new credential<br/>(fresh application)
    
    state Decommissioned {
        [*] --> Burned
        note right of Burned
            Entity native asset burned
            All credentials revoked
            TIT Vault settled
            DID archived (resolvable)
        end note
    }
    
    Decommissioned --> [*]: Permanent
