# Period Review Redesign - Technical Architecture

> **Project:** CoCoA Phase 3 - Interactive Period Reviews  
> **Status:** Design Phase  
> **Created:** 2025-11-03

---

## System Overview

Transform period reviews from auto-generated placeholder content to meaningful, conversation-driven reflections through a three-phase workflow.

### Workflow Phases

```
┌─────────────────────────────────────────────────────────────────┐
│ PHASE 1: Automated Stats Gathering                              │
│ Script: period-review-stats.ps1                                 │
│ Trigger: Scheduled task at 4:00 PM daily                        │
│                                                                  │
│ Actions:                                                         │
│ 1. Parse Daily-Focus.md for completion stats                    │
│ 2. Detect period boundaries (EOD/EOW/EOM/EOQ/EOY)               │
│ 3. Scan Projects\ for next-actions                              │
│ 4. Generate review-context.json with all data                   │
│ 5. Create scaffold review files (stats sections only)           │
│ 6. Desktop notification: "CoCoA: Ready for [PERIOD] review"     │
│                                                                  │
│ Output: review-context.json + scaffold files                    │
└─────────────────────────────────────────────────────────────────┘
                              ↓
┌─────────────────────────────────────────────────────────────────┐
│ PHASE 2: Interactive Review Conversation                        │
│ Agent: CoCoA (Claude)                                            │
│ Trigger: Manual - user clicks Claude Desktop                    │
│                                                                  │
│ Actions:                                                         │
│ 1. Read review-context.json                                     │
│ 2. Determine which periods need review                          │
│ 3. Ask period-appropriate questions                             │
│ 4. Capture user responses                                       │
│ 5. Format responses as markdown sections                        │
│ 6. Save to review-responses.json                                │
│ 7. Trigger finalization script                                  │
│                                                                  │
│ Output: review-responses.json                                   │
└─────────────────────────────────────────────────────────────────┘
                              ↓
┌─────────────────────────────────────────────────────────────────┐
│ PHASE 3: File Finalization                                      │
│ Script: period-review-finalize.ps1                              │
│ Trigger: Called by CoCoA after conversation                     │
│                                                                  │
│ Actions:                                                         │
│ 1. Read review-context.json + review-responses.json             │
│ 2. Merge stats + user content into final review files           │
│ 3. Generate next Daily-Focus.md                                 │
│ 4. Archive completed review files                               │
│ 5. Desktop notification: "Period reviews complete!"             │
│                                                                  │
│ Output: Final review files + updated Daily-Focus.md             │
└─────────────────────────────────────────────────────────────────┘
```

---

## Data Exchange Format

### review-context.json

Generated by Phase 1, consumed by Phase 2 & 3.

```json
{
  "timestamp": "2025-11-03T16:00:00Z",
  "current_date": "2025-11-03",
  "periods_ending": ["EOD", "EOW"],
  "stats": {
    "total_tasks": 7,
    "completed_tasks": 6,
    "completion_rate": 85.7,
    "deep_work": {
      "task": "Complete CoCoA period review redesign",
      "completed": true
    },
    "two_others": [
      {
        "task": "Review client proposal",
        "completed": true
      },
      {
        "task": "Update project documentation",
        "completed": false
      }
    ],
    "blocked_items": [
      "Waiting on client feedback for milestone 2"
    ],
    "notes": [
      "Good focus today despite interruptions",
      "Need to schedule team sync for next week"
    ]
  },
  "project_actions": [
    {
      "project": "CoCoA-Development",
      "task": "Implement period review conversation flow"
    },
    {
      "project": "C3-Alliance",
      "task": "Review smart contract audit results"
    },
    {
      "project": "Client-Project-Alpha",
      "task": "Draft technical specification document"
    }
  ],
  "next_work_date": "2025-11-04",
  "week_context": {
    "week_number": 44,
    "days_this_week": 5,
    "is_end_of_week": true
  },
  "month_context": {
    "month": 11,
    "month_name": "November",
    "is_end_of_month": false
  }
}
```

### review-responses.json

Generated by Phase 2, consumed by Phase 3.

```json
{
  "timestamp": "2025-11-03T16:15:00Z",
  "periods_reviewed": ["EOD", "EOW"],
  "responses": {
    "EOD": {
      "how_day_went": "Really productive day. The deep work block was focused and uninterrupted. Made significant progress on the period review redesign.",
      "deep_work_reflection": "Completed the architecture design for the interactive review system. The three-phase approach feels solid.",
      "blockers": "None today - had good flow state during deep work.",
      "tomorrow_priority": "Start implementing the stats gathering script modifications.",
      "additional_notes": null
    },
    "EOW": {
      "weekly_wins": [
        "Completed CoCoA Phase 2 testing with 99% success rate",
        "Resolved MCP configuration issues",
        "Designed comprehensive period review redesign"
      ],
      "challenges": [
        "Some time lost troubleshooting BOM encoding issues",
        "Client communication delays on one project"
      ],
      "learnings": [
        "The importance of meaningful reflection vs auto-generated content",
        "Need to build in more buffer time for MCP troubleshooting"
      ],
      "next_week_priorities": [
        "Implement period review redesign (Phase 1 & 2)",
        "Complete client proposal revisions",
        "Begin C3 Alliance smart contract integration"
      ]
    }
  }
}
```

---

## File Structure

### Project Files
```
D:\Claude-MCP-Files\CoCoA-Project\workflows\
├── period-review-stats.ps1          # Phase 1: Stats gathering
├── period-review-finalize.ps1       # Phase 3: File generation
├── period-review-templates/         # Template files
│   ├── daily-template.md
│   ├── weekly-template.md
│   ├── monthly-template.md
│   ├── quarterly-template.md
│   └── annual-template.md
└── temp/                            # Temporary data exchange
    ├── review-context.json
    └── review-responses.json
```

### Review Output Locations
```
C:\PlausiblePotentials-Files\My files\My Notes\PPC\Next-Actions\
├── EOD-Reviews/
│   └── YYYY-MM-DD-Daily.md
├── EOW-Reviews/
│   └── YYYY-MM-DD-Weekly.md
├── EOM-Reviews/
│   └── YYYY-MM-Monthly.md
├── EOQ-Reviews/
│   └── YYYY-Q#-Quarterly.md
└── EOY-Reviews/
    └── YYYY-Annual.md
```

---

## Template Structure

### Section Types

**Auto-Populated Sections** (Phase 1)
- Date/timestamp headers
- Performance stats (completion rates)
- Task lists (deep work, two others)
- Blocked items
- Daily notes
- Project next-actions scan

**User-Provided Sections** (Phase 2)
- Reflections (how day/week/month went)
- What went well / wins
- Challenges encountered
- Key learnings / insights
- Next period priorities

**Computed Sections** (Phase 3)
- Trends analysis (for weekly+)
- Completion rate comparisons
- Project velocity tracking (for monthly+)

### Template Markers

Templates use placeholder markers that get replaced during finalization:

- `{{STATS_*}}` - Replaced with computed statistics
- `{{USER_*}}` - Replaced with user conversation responses
- `{{DATE_*}}` - Replaced with formatted dates
- `{{PROJECT_*}}` - Replaced with project scan results

---

## Conversation Flows

### Daily Review (EOD)

**Opening:**
"Time for your end-of-day review! You completed **{completion_rate}%** of tasks today. Let's reflect on how things went."

**Questions:**
1. "How did today go overall? What stood out?"
2. "Your deep work task was: '{deep_work_task}' - {status}. How did that session go?"
3. "What (if anything) blocked or slowed you down today?"
4. "Looking at tomorrow - what's your #1 priority for the deep work block?"

**Follow-ups:**
- If completion < 70%: "I notice completion was lower today. Any insights on why?"
- If blocked items: "You noted '{blocked_item}' - is this still blocking or can we move it?"
- If no deep work completed: "What got in the way of the deep work block?"

### Weekly Review (EOW)

**Opening:**
"End of week! Let's review the past 5 days. Your average completion rate was **{avg_completion}%**."

**Questions:**
1. "What were your biggest wins this week?"
2. "What challenges came up?"
3. "What did you learn this week?"
4. "Looking at next week - what are your top 3 priorities?"

**Context Provided:**
- List of deep work tasks completed this week
- Project momentum indicators
- Recurring blockers

### Monthly Review (EOM)

**Opening:**
"Month-end review for {month}. Let's look at the bigger picture."

**Questions:**
1. "What were the major accomplishments this month?"
2. "Which projects moved forward significantly? Which stalled?"
3. "What patterns do you notice in how you're working?"
4. "What are your strategic priorities for {next_month}?"

**Context Provided:**
- Monthly completion rate trend
- Project progress summary
- Goal progress (if goals defined)

### Quarterly Review (EOQ)

**Opening:**
"Quarter {Q#} is wrapping up. Time for strategic reflection."

**Questions:**
1. "What were the key achievements this quarter?"
2. "How did your projects progress against Q{#} goals?"
3. "What strategic shifts are needed for Q{#+1}?"
4. "What 3-5 OKRs should drive Q{#+1}?"

**Context Provided:**
- Quarterly trends
- Project velocity analysis
- Goal achievement summary

### Annual Review (EOY)

**Opening:**
"End of {year}. Let's reflect on the full year and plan for {year+1}."

**Questions:**
1. "What were your biggest professional accomplishments in {year}?"
2. "What did you learn about yourself and your work this year?"
3. "What will you do differently in {year+1}?"
4. "What are your strategic themes for {year+1}?"

**Context Provided:**
- Annual statistics
- Year-over-year trends
- Major project outcomes

---

## Implementation Checklist

### Phase 1: Stats Script
- [ ] Modify existing period-review.ps1
- [ ] Remove content generation functions
- [ ] Add JSON output generation
- [ ] Create temp/ folder management
- [ ] Update notification text
- [ ] Test period detection
- [ ] Test stats parsing
- [ ] Test project scanning

### Phase 2: CoCoA Conversation
- [ ] Create conversation flow skill
- [ ] Implement JSON reading
- [ ] Build question selection logic
- [ ] Create response capture system
- [ ] Format responses as markdown
- [ ] Generate review-responses.json
- [ ] Test conversation flow
- [ ] Test multi-period handling (EOD+EOW)

### Phase 3: Finalization Script
- [ ] Create period-review-finalize.ps1
- [ ] Build JSON merging logic
- [ ] Create template rendering engine
- [ ] Implement file writing
- [ ] Generate next Daily-Focus.md
- [ ] Test with mock data
- [ ] Test error handling
- [ ] Test notification

### Phase 4: Templates
- [ ] Create daily-template.md
- [ ] Create weekly-template.md
- [ ] Create monthly-template.md
- [ ] Create quarterly-template.md
- [ ] Create annual-template.md
- [ ] Define placeholder markers
- [ ] Test template rendering

### Phase 5: Integration
- [ ] Update scheduled task configuration
- [ ] Test end-to-end workflow
- [ ] Test multi-period scenarios
- [ ] Document usage for JW
- [ ] Create troubleshooting guide

---

## Success Metrics

✅ **Functional Requirements**
- Stats gathered automatically without user input
- Period boundaries detected correctly
- User provides ALL reflection content via conversation
- Review files contain zero placeholder text
- Priorities explicitly discussed and confirmed
- Process handles multi-period reviews (EOD+EOW+EOM)

✅ **User Experience**
- Conversation feels natural, not like form-filling
- Questions adapt to context (completion rates, blockers, etc.)
- Takes < 5 minutes for daily, < 10 minutes for weekly
- Next-day priorities clearly established
- No manual file editing required

✅ **Technical Quality**
- Scripts run reliably on schedule
- Error handling for missing files/data
- JSON format validation
- Desktop notifications work consistently
- File generation succeeds 100% of time

---

## Risk Mitigation

### Risk: Script fails during stats gathering
**Mitigation:** Comprehensive error handling, fallback to manual review

### Risk: User doesn't complete conversation
**Mitigation:** Scaffold files saved, can resume conversation later

### Risk: JSON corruption/invalid format
**Mitigation:** Schema validation, backup temp files

### Risk: Multi-period reviews too long
**Mitigation:** Group similar questions, allow "carry forward" responses

---

## Future Enhancements

- **Trend Analysis:** Visualize completion rates over time
- **Goal Tracking:** Integrate OKR/goal progress
- **AI Insights:** CoCoA suggests patterns in work habits
- **Voice Input:** Allow voice responses for faster reviews
- **Mobile Access:** Trigger reviews from phone if away from desk
- **Team Reviews:** Extend to team retrospectives

---

*Architecture v1.0 - Ready for Implementation*
